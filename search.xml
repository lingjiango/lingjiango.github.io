<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Kafka单机版环境搭建</title>
    <url>/2020/11/08/Kafka%E5%8D%95%E6%9C%BA%E7%89%88%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    <content><![CDATA[<h4 id="1-工具准备"><a href="#1-工具准备" class="headerlink" title="1.工具准备"></a>1.工具准备</h4><table>
<thead>
<tr>
<th>软件</th>
<th>版本</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>Hyper-V</td>
<td>10.0.18362.1</td>
<td>虚拟化工具，负责安装多个节点</td>
</tr>
<tr>
<td>CentOS</td>
<td>7</td>
<td>Linux操作系统,对应到每台机器</td>
</tr>
<tr>
<td>Kafka</td>
<td>2.12-1.0.2</td>
<td>日志收集和消息系统</td>
</tr>
<tr>
<td>Zookeeper</td>
<td>3.5.8</td>
<td>分布式协调组件</td>
</tr>
<tr>
<td>Jdk</td>
<td>1.8</td>
<td>适配Kafka版本</td>
</tr>
<tr>
<td>Xshell</td>
<td>5</td>
<td>远程连接shell工具</td>
</tr>
<tr>
<td>Xftp</td>
<td>6</td>
<td>远程文件管理工具</td>
</tr>
</tbody></table>
<h4 id="2-环境搭建及架构描述"><a href="#2-环境搭建及架构描述" class="headerlink" title="2.环境搭建及架构描述"></a>2.环境搭建及架构描述</h4><table>
<thead>
<tr>
<th>机器名称</th>
<th>角色</th>
</tr>
</thead>
<tbody><tr>
<td>Centos7</td>
<td>单机版</td>
</tr>
</tbody></table>
<h4 id="3-搭建步骤"><a href="#3-搭建步骤" class="headerlink" title="3.搭建步骤"></a>3.搭建步骤</h4><h5 id="3-1-搭建JDK环境"><a href="#3-1-搭建JDK环境" class="headerlink" title="3.1 搭建JDK环境"></a>3.1 搭建JDK环境</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rpm -ivh jdk-8u261-linux-x64.rpm</span><br><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_261-amd64</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br><span class="line">java -version</span><br></pre></td></tr></table></figure>

<h5 id="3-2-搭建ZooKeeper环境"><a href="#3-2-搭建ZooKeeper环境" class="headerlink" title="3.2 搭建ZooKeeper环境"></a>3.2 搭建ZooKeeper环境</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxf apache-zookeeper-3.5.8-bin.tar.gz -C /opt</span><br><span class="line">cd /opt/apache-zookeeper-3.5.8-bin/conf</span><br><span class="line">cp zoo_sample.cfg zoo.cfg</span><br><span class="line">vim zoo.cfg</span><br><span class="line"></span><br><span class="line">dataDir=/var/lingjiango/zookeeper/data</span><br><span class="line"></span><br><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line">export ZOOKEEPER_PREFIX=/opt/apache-zookeeper-3.5.8-bin</span><br><span class="line">export PATH=$PATH:$ZOOKEEPER_PREFIX/bin</span><br><span class="line">export ZOO_LOG_DIR=/var/lingjiango/zookeeper/log</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line">zkServer.sh status</span><br></pre></td></tr></table></figure>



<h5 id="3-3-搭建Kafka环境"><a href="#3-3-搭建Kafka环境" class="headerlink" title="3.3 搭建Kafka环境"></a>3.3 搭建Kafka环境</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxf kafka_2.12-1.0.2.tgz -C /opt</span><br><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line">export KAFKA_HOME=/opt/kafka_2.12-1.0.2</span><br><span class="line">export PATH=$PATH:$KAFKA_HOME/bin</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line">cd /opt/kafka_2.12-1.0.2/config</span><br><span class="line">vim server.properties</span><br><span class="line"></span><br><span class="line">log.dirs=/var/lingjiango/kafka/kafka-logs</span><br><span class="line">zookeeper.connect=localhost:2181/kafka</span><br><span class="line"></span><br><span class="line">mkdir -p /var/lingjiango/kafka/kafka-logs</span><br></pre></td></tr></table></figure>

<h5 id="3-4-验证搭建成果"><a href="#3-4-验证搭建成果" class="headerlink" title="3.4 验证搭建成果"></a>3.4 验证搭建成果</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">zkServer.sh start</span><br><span class="line">zkServer.sh status</span><br><span class="line"></span><br><span class="line">kafka-server-start.sh -daemon config/server.properties</span><br><span class="line">ps -ef | grep kafka</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kafka-topics.sh --zookeeper localhost:2181/kafka --create --topic topic_1 --partitions 1 --replication-factor 1</span><br><span class="line">kafka-topics.sh --zookeeper localhost:2181/kafka --list</span><br></pre></td></tr></table></figure>

<img src="image-20201109000032124.png" alt="image-20201109000032124" style="zoom:200%;" />

<p>能看到这个图片效果说明单机版的kafka环境搭建完成。</p>
]]></content>
      <categories>
        <category>Kafka</category>
      </categories>
      <tags>
        <tag>Kafka</tag>
        <tag>消息中间件</tag>
      </tags>
  </entry>
  <entry>
    <title>RabbitMQ单机版环境搭建</title>
    <url>/2020/11/01/RabbitMQ%E5%8D%95%E6%9C%BA%E7%89%88%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    <content><![CDATA[<h4 id="1-工具准备"><a href="#1-工具准备" class="headerlink" title="1.工具准备"></a>1.工具准备</h4><table>
<thead>
<tr>
<th>软件</th>
<th>版本</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>Hyper-V</td>
<td>10.0.18362.1</td>
<td>虚拟化工具，负责安装多个节点</td>
</tr>
<tr>
<td>CentOS</td>
<td>7</td>
<td>Linux操作系统,对应到每台机器</td>
</tr>
<tr>
<td>Erlang</td>
<td>23.0.2-1.el7.x86_64</td>
<td>RabbitMQ运行环境</td>
</tr>
<tr>
<td>RabbitMQ</td>
<td>server-3.8.4-1.el7.noarch</td>
<td>消息中间件</td>
</tr>
<tr>
<td>Xshell</td>
<td>5</td>
<td>远程连接shell工具</td>
</tr>
<tr>
<td>Xftp</td>
<td>6</td>
<td>远程文件管理工具</td>
</tr>
</tbody></table>
<h4 id="2-环境搭建及架构描述"><a href="#2-环境搭建及架构描述" class="headerlink" title="2.环境搭建及架构描述"></a>2.环境搭建及架构描述</h4><table>
<thead>
<tr>
<th>机器名称</th>
<th>角色</th>
</tr>
</thead>
<tbody><tr>
<td>Centos7</td>
<td>单机版</td>
</tr>
</tbody></table>
<h4 id="3-搭建步骤"><a href="#3-搭建步骤" class="headerlink" title="3.搭建步骤"></a>3.搭建步骤</h4><h5 id="3-1-搭建RabbitMQ环境"><a href="#3-1-搭建RabbitMQ环境" class="headerlink" title="3.1 搭建RabbitMQ环境"></a>3.1 搭建RabbitMQ环境</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install socat -y</span><br><span class="line"></span><br><span class="line">rpm -ivh erlang-23.0.2-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh rabbitmq-server-3.8.5-1.el7.noarch.rpm</span><br><span class="line"></span><br><span class="line">rabbitmq-plugins enable rabbitmq_management</span><br><span class="line"></span><br><span class="line">rabbitmq-server -detached</span><br><span class="line">rabbitmqctl add_user lingjiango 123456</span><br><span class="line">rabbitmqctl set_permissions lingjiango -p / &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span><br><span class="line">rabbitmqctl set_user_tags lingjiango administrator</span><br></pre></td></tr></table></figure>

<p>最后，可以通过管理工具来验证一下RabbitMQ是否搭建成功。</p>
<img src="image-20201101160524887.png" alt="image-20201101160524887" style="zoom:200%;" />]]></content>
      <categories>
        <category>RabbitMQ</category>
      </categories>
      <tags>
        <tag>消息中间件</tag>
        <tag>RabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title>RocketMQ单机版环境搭建</title>
    <url>/2020/11/15/RocketMQ%E5%8D%95%E6%9C%BA%E7%89%88%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    <content><![CDATA[<h4 id="1-工具准备"><a href="#1-工具准备" class="headerlink" title="1.工具准备"></a>1.工具准备</h4><table>
<thead>
<tr>
<th>软件</th>
<th>版本</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>Hyper-V</td>
<td>10.0.18362.1</td>
<td>虚拟化工具，负责安装多个节点</td>
</tr>
<tr>
<td>CentOS</td>
<td>7</td>
<td>Linux操作系统,对应到每台机器</td>
</tr>
<tr>
<td>RocketMQ</td>
<td>4.5.1</td>
<td>消息中间件</td>
</tr>
<tr>
<td>Jdk</td>
<td>11</td>
<td></td>
</tr>
<tr>
<td>Xshell</td>
<td>5</td>
<td>远程连接shell工具</td>
</tr>
<tr>
<td>Xftp</td>
<td>6</td>
<td>远程文件管理工具</td>
</tr>
</tbody></table>
<h4 id="2-环境搭建及架构描述"><a href="#2-环境搭建及架构描述" class="headerlink" title="2.环境搭建及架构描述"></a>2.环境搭建及架构描述</h4><table>
<thead>
<tr>
<th>机器名称</th>
<th>角色</th>
</tr>
</thead>
<tbody><tr>
<td>Centos7</td>
<td>单机版</td>
</tr>
</tbody></table>
<h4 id="3-搭建步骤"><a href="#3-搭建步骤" class="headerlink" title="3.搭建步骤"></a>3.搭建步骤</h4><h5 id="3-1-搭建JDK环境"><a href="#3-1-搭建JDK环境" class="headerlink" title="3.1 搭建JDK环境"></a>3.1 搭建JDK环境</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/profile</span><br><span class="line">export JAVA_HOME=/usr/local/jdk11</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br><span class="line">java -version</span><br></pre></td></tr></table></figure>

<h5 id="3-2-搭建RocketMQ-环境"><a href="#3-2-搭建RocketMQ-环境" class="headerlink" title="3.2 搭建RocketMQ  环境"></a>3.2 搭建RocketMQ  环境</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum -y install zip unzip</span><br><span class="line"></span><br><span class="line">unzip rocketmq-all-4.5.1-bin-release.zip -d /opt</span><br><span class="line"></span><br><span class="line">cd /opt</span><br><span class="line">mv rocketmq-all-4.5.1-bin-release rocket</span><br><span class="line">cd rocket</span><br><span class="line"></span><br><span class="line">vim /etc/profile</span><br><span class="line">export ROCKET_HOME=/opt/rocket</span><br><span class="line">export PATH=$PATH:$ROCKET_HOME/bin</span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line">vim bin/runserver.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> !/bin/sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Licensed to the Apache Software Foundation (ASF) under one or more</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> contributor license agreements. See the NOTICE file distributed with</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> this work <span class="keyword">for</span> additional information regarding copyright ownership.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The ASF licenses this file to You under the Apache License, Version 2.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (the <span class="string">&quot;License&quot;</span>); you may not use this file except <span class="keyword">in</span> compliance with</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the License. You may obtain a copy of the License at</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Unless required by applicable law or agreed to <span class="keyword">in</span> writing, software</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> distributed under the License is distributed on an <span class="string">&quot;AS IS&quot;</span> BASIS,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> See the License <span class="keyword">for</span> the specific language governing permissions and</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> limitations under the License.</span></span><br><span class="line"><span class="meta">#</span><span class="bash">==========================================================================</span></span><br><span class="line">=================</span><br><span class="line"><span class="meta">#</span><span class="bash"> Java Environment Setting</span></span><br><span class="line"><span class="meta">#</span><span class="bash">==========================================================================</span></span><br><span class="line">=================</span><br><span class="line">error_exit ()</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;ERROR: $1 !!&quot;</span><br><span class="line">exit 1</span><br><span class="line">&#125; [</span><br><span class="line">! -e &quot;$JAVA_HOME/bin/java&quot; ] &amp;&amp; JAVA_HOME=$HOME/jdk/java</span><br><span class="line">[ ! -e &quot;$JAVA_HOME/bin/java&quot; ] &amp;&amp; JAVA_HOME=/usr/java</span><br><span class="line">[ ! -e &quot;$JAVA_HOME/bin/java&quot; ] &amp;&amp; error_exit &quot;Please set the JAVA_HOME</span><br><span class="line">variable in your environment, We need java(x64)!&quot;</span><br><span class="line">export JAVA_HOME</span><br><span class="line">export JAVA=&quot;$JAVA_HOME/bin/java&quot;</span><br><span class="line">export BASE_DIR=$(dirname $0)/..</span><br><span class="line">export</span><br><span class="line">CLASSPATH=.:$&#123;BASE_DIR&#125;/conf:$&#123;JAVA_HOME&#125;/jre/lib/ext:$&#123;BASE_DIR&#125;/lib/*</span><br><span class="line"><span class="meta">#</span><span class="bash">==========================================================================</span></span><br><span class="line">=================</span><br><span class="line"><span class="meta">#</span><span class="bash"> JVM Configuration</span></span><br><span class="line"><span class="meta">#</span><span class="bash">==========================================================================</span></span><br><span class="line">=================</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -server -Xms256m -Xmx256m -Xmn128m -</span><br><span class="line">XX:MetaspaceSize=64m -XX:MaxMetaspaceSize=160m&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -XX:CMSInitiatingOccupancyFraction=70 -</span><br><span class="line">XX:+CMSParallelRemarkEnabled -XX:SoftRefLRUPolicyMSPerMB=0 -</span><br><span class="line">XX:+CMSClassUnloadingEnabled -XX:SurvivorRatio=8&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -verbose:gc -Xlog:gc:/dev/shm/rmq_srv_gc.log -</span><br><span class="line">XX:+PrintGCDetails&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -XX:-OmitStackTraceInFastThrow&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -XX:-UseLargePages&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> JAVA_OPT=<span class="string">&quot;<span class="variable">$&#123;JAVA_OPT&#125;</span> -</span></span></span><br><span class="line">Djava.ext.dirs=$&#123;JAVA_HOME&#125;/jre/lib/ext:$&#123;BASE_DIR&#125;/lib&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash">JAVA_OPT=<span class="string">&quot;<span class="variable">$&#123;JAVA_OPT&#125;</span> -Xdebug -</span></span></span><br><span class="line">Xrunjdwp:transport=dt_socket,address=9555,server=y,suspend=n&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; $&#123;JAVA_OPT_EXT&#125;&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -cp $&#123;CLASSPATH&#125;&quot;</span><br><span class="line"><span class="meta">$</span><span class="bash">JAVA <span class="variable">$&#123;JAVA_OPT&#125;</span> <span class="variable">$@</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vim bin/runbroker.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> !/bin/sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Licensed to the Apache Software Foundation (ASF) under one or more</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> contributor license agreements. See the NOTICE file distributed with</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> this work <span class="keyword">for</span> additional information regarding copyright ownership.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The ASF licenses this file to You under the Apache License, Version 2.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (the <span class="string">&quot;License&quot;</span>); you may not use this file except <span class="keyword">in</span> compliance with</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the License. You may obtain a copy of the License at</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Unless required by applicable law or agreed to <span class="keyword">in</span> writing, software</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> distributed under the License is distributed on an <span class="string">&quot;AS IS&quot;</span> BASIS,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> See the License <span class="keyword">for</span> the specific language governing permissions and</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> limitations under the License.</span></span><br><span class="line"><span class="meta">#</span><span class="bash">===========================================================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Java Environment Setting</span></span><br><span class="line"><span class="meta">#</span><span class="bash">===========================================================================================</span></span><br><span class="line">error_exit ()</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;ERROR: $1 !!&quot;</span><br><span class="line">exit 1</span><br><span class="line">&#125; [</span><br><span class="line">! -e &quot;$JAVA_HOME/bin/java&quot; ] &amp;&amp; JAVA_HOME=$HOME/jdk/java</span><br><span class="line">[ ! -e &quot;$JAVA_HOME/bin/java&quot; ] &amp;&amp; JAVA_HOME=/usr/java</span><br><span class="line">[ ! -e &quot;$JAVA_HOME/bin/java&quot; ] &amp;&amp; error_exit &quot;Please set the JAVA_HOME variable in your environment, We need java(x64)!&quot;</span><br><span class="line">export JAVA_HOME</span><br><span class="line">export JAVA=&quot;$JAVA_HOME/bin/java&quot;</span><br><span class="line">export BASE_DIR=$(dirname $0)/..</span><br><span class="line">export CLASSPATH=.$&#123;JAVA_HOME&#125;/jre/lib/ext:$&#123;BASE_DIR&#125;/lib/*:$&#123;BASE_DIR&#125;/conf:$&#123;CLASSPATH&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash">===========================================================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> JVM Configuration</span></span><br><span class="line"><span class="meta">#</span><span class="bash">===========================================================================================</span></span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -server -Xms256m -Xmx256m -Xmn128m&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -XX:+UseG1GC -XX:G1HeapRegionSize=16m -XX:G1ReservePercent=25 -XX:InitiatingHeapOccupancyPercent=30 -XX:SoftRefLRUPolicyMSPerMB=0&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -verbose:gc -Xloggc:/dev/shm/mq_gc_%p.log -XX:+PrintGCDetails&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -XX:-OmitStackTraceInFastThrow&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -XX:+AlwaysPreTouch&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -XX:MaxDirectMemorySize=15g&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -XX:-UseLargePages -XX:-UseBiasedLocking&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash">JAVA_OPT=<span class="string">&quot;<span class="variable">$&#123;JAVA_OPT&#125;</span> -Xdebug -Xrunjdwp:transport=dt_socket,address=9555,server=y,suspend=n&quot;</span></span></span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; $&#123;JAVA_OPT_EXT&#125;&quot;</span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -cp $&#123;CLASSPATH&#125;&quot;</span><br><span class="line">numactl --interleave=all pwd &gt; /dev/null 2&gt;&amp;1</span><br><span class="line">if [ $? -eq 0 ]</span><br><span class="line">then</span><br><span class="line">if [ -z &quot;$RMQ_NUMA_NODE&quot; ] ; then</span><br><span class="line">numactl --interleave=all $JAVA $&#123;JAVA_OPT&#125; $@</span><br><span class="line">else</span><br><span class="line">numactl --cpunodebind=$RMQ_NUMA_NODE --membind=$RMQ_NUMA_NODE $JAVA</span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;JAVA_OPT&#125; <span class="variable">$@</span></span></span><br><span class="line">fi</span><br><span class="line">else</span><br><span class="line"><span class="meta">$</span><span class="bash">JAVA <span class="variable">$&#123;JAVA_OPT&#125;</span> --add-exports=java.base/jdk.internal.ref=ALL-UNNAMED</span></span><br><span class="line"><span class="meta">$</span><span class="bash">@</span></span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vim bin/tools.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> !/bin/sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Licensed to the Apache Software Foundation (ASF) under one or more</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> contributor license agreements. See the NOTICE file distributed with</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> this work <span class="keyword">for</span> additional information regarding copyright ownership.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The ASF licenses this file to You under the Apache License, Version 2.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> (the <span class="string">&quot;License&quot;</span>); you may not use this file except <span class="keyword">in</span> compliance with</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the License. You may obtain a copy of the License at</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Unless required by applicable law or agreed to <span class="keyword">in</span> writing, software</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> distributed under the License is distributed on an <span class="string">&quot;AS IS&quot;</span> BASIS,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> See the License <span class="keyword">for</span> the specific language governing permissions and</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> limitations under the License.</span></span><br><span class="line"><span class="meta">#</span><span class="bash">==========================================================================</span></span><br><span class="line">=================</span><br><span class="line"><span class="meta">#</span><span class="bash"> Java Environment Setting</span></span><br><span class="line"><span class="meta">#</span><span class="bash">==========================================================================</span></span><br><span class="line">=================</span><br><span class="line">error_exit ()</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;ERROR: $1 !!&quot;</span><br><span class="line">exit 1</span><br><span class="line">&#125; </span><br><span class="line">[ ! -e &quot;$JAVA_HOME/bin/java&quot; ] &amp;&amp; JAVA_HOME=$HOME/jdk/java</span><br><span class="line">[ ! -e &quot;$JAVA_HOME/bin/java&quot; ] &amp;&amp; JAVA_HOME=/usr/java</span><br><span class="line">[ ! -e &quot;$JAVA_HOME/bin/java&quot; ] &amp;&amp; error_exit &quot;Please set the JAVA_HOME variable in your environment, We need java(x64)!&quot;</span><br><span class="line">export JAVA_HOME</span><br><span class="line">export JAVA=&quot;$JAVA_HOME/bin/java&quot;</span><br><span class="line">export BASE_DIR=$(dirname $0)/..</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">export</span> CLASSPATH=.:<span class="variable">$&#123;BASE_DIR&#125;</span>/conf:<span class="variable">$&#123;CLASSPATH&#125;</span></span></span><br><span class="line">export CLASSPATH=.$&#123;JAVA_HOME&#125;/jre/lib/ext:$&#123;BASE_DIR&#125;/lib/*:$&#123;BASE_DIR&#125;/conf:$&#123;CLASSPATH&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash">===========================================================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> JVM Configuration</span></span><br><span class="line"><span class="meta">#</span><span class="bash">===========================================================================================</span></span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -server -Xms256m -Xmx256m -Xmn256m -XX:PermSize=128m -XX:MaxPermSize=128m&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> JAVA_OPT=<span class="string">&quot;<span class="variable">$&#123;JAVA_OPT&#125;</span> -Djava.ext.dirs=<span class="variable">$&#123;BASE_DIR&#125;</span>/lib:<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre/lib/ext&quot;</span></span></span><br><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -cp $&#123;CLASSPATH&#125;&quot;</span><br><span class="line"><span class="meta">$</span><span class="bash">JAVA <span class="variable">$&#123;JAVA_OPT&#125;</span> <span class="variable">$@</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1.启动NameServer</span></span><br><span class="line">mqnamesrv</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.查看启动日志</span></span><br><span class="line">tail -f ~/logs/rocketmqlogs/namesrv.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1.启动Broker</span></span><br><span class="line">mqbroker -n localhost:9876</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.查看启动日志</span></span><br><span class="line">tail -f ~/logs/rocketmqlogs/broker.log</span><br></pre></td></tr></table></figure>

<h5 id="3-3-验证搭建成果"><a href="#3-3-验证搭建成果" class="headerlink" title="3.3 验证搭建成果"></a>3.3 验证搭建成果</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.设置环境变量</span></span><br><span class="line">export NAMESRV_ADDR=localhost:9876</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.使用安装包的Demo发送消息</span></span><br><span class="line">sh bin/tools.sh org.apache.rocketmq.example.quickstart.Producer</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1.设置环境变量</span></span><br><span class="line">export NAMESRV_ADDR=localhost:9876</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.接收消息</span></span><br><span class="line">sh bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1.关闭NameServer</span></span><br><span class="line">mqshutdown namesrv</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.关闭Broker</span></span><br><span class="line">mqshutdown broker</span><br></pre></td></tr></table></figure>

<p>能看到消息正常发送和消费即表示单机环境搭建完成。</p>
<img src="image-20201115161014082.png" alt="image-20201115161014082" style="zoom:200%;" />

<img src="image-20201115161037584.png" alt="image-20201115161037584" style="zoom:200%;" />]]></content>
      <categories>
        <category>RocketMQ</category>
      </categories>
      <tags>
        <tag>消息中间件</tag>
        <tag>RocketMQ</tag>
      </tags>
  </entry>
</search>
